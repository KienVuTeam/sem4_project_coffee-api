<table class='table table-striped' id="tableDetailProduct">
	<thead>
		<tr>
			<th>No.</th>
			<th>Product Name</th>
			<th>Price</th>
			<th>Quantity</th>
			<th>Sub-Price</th>
			<th>Confirm</th>
			<th>No Confirm</th>
		</tr>
	</thead>
	<tbody>
		<tr th:each="item, iter:${lstDetailOrderBySupp}">
			<td th:text="${iter.index+1}"></td>
			<td th:text="${item.nameProduct}">Coffee ngon</td>
			<td><span th:id="'tdPriceOrder'+${iter.index}" th:text="${item.priceOrder}"></span><span>.00</span></td>
			<td th:text="${item.Amount}"></td>
			<td><span th:text="${item.Price}"></span><span>.00</span></td>
			<th:block th:switch="${item.isStatus}">
				<th:block th:case="'0'">
					<td>
						<li class="d-inline-block me-2 mb-1">
							<div class='form-check'>
								<div class="checkbox">
									<input type="checkbox" id="checkbox3" class='form-check-input' disabled>
									<label for="checkbox3"></label>
								</div>
							</div>
						</li>
					</td>
					<td>
						<li class="d-inline-block mb-1">
							<div class='form-check'>
								<div class="checkbox">
									<input type="checkbox" id="checkbox4" class='form-check-input' disabled>
									<label for="checkbox4"></label>
								</div>
							</div>
						</li>
					</td>
				</th:block>
				<th:block th:case="'1'">
					<td>
						<li class="d-inline-block me-2 mb-1">
							<div class='form-check'>
								<div class="checkbox">
									<input type="checkbox" id="checkbox3" class='form-check-input' disabled checked>
									<label for="checkbox3"></label>
								</div>
							</div>
						</li>
					</td>
					<td>
						<li class="d-inline-block mb-1">
							<div class='form-check'>
								<div class="checkbox">
									<input type="checkbox" id="checkbox4" class='form-check-input' disabled>
									<label for="checkbox4"></label>
								</div>
							</div>
						</li>
					</td>
				</th:block>
				<th:block th:case="'2'">
					<td>
						<li class="d-inline-block me-2 mb-1">
							<div class='form-check'>
								<div class="checkbox">
									<input type="checkbox" id="checkbox3" class='form-check-input' disabled>
									<label for="checkbox3"></label>
								</div>
							</div>
						</li>
					</td>
					<td>
						<li class="d-inline-block mb-1">
							<div class='form-check'>
								<div class="checkbox">
									<input type="checkbox" id="checkbox4" class='form-check-input' disabled checked>
									<label for="checkbox4"></label>
								</div>
							</div>
						</li>
					</td>
				</th:block>
				<th:block th:case="'3'">
					<td>
						<li class="d-inline-block me-2 mb-1">
							<div class='form-check'>
								<div class="checkbox">
									<input type="checkbox" id="checkbox3" class='form-check-input' disabled>
									<label for="checkbox3"></label>
								</div>
							</div>
						</li>
					</td>
					<td>
						<li class="d-inline-block mb-1">
							<div class='form-check'>
								<div class="checkbox">
									<input type="checkbox" id="checkbox4" class='form-check-input' disabled checked>
									<label for="checkbox4"></label>
								</div>
							</div>
						</li>
					</td>
				</th:block>
				<th:block th:case="'4'">
					<td>
						<li class="d-inline-block me-2 mb-1">
							<div class='form-check'>
								<div class="checkbox">
									<input type="checkbox" id="checkbox3" class='form-check-input' disabled checked>
									<label for="checkbox3"></label>
								</div>
							</div>
						</li>
					</td>
					<td>
						<li class="d-inline-block mb-1">
							<div class='form-check'>
								<div class="checkbox">
									<input type="checkbox" id="checkbox4" class='form-check-input' disabled>
									<label for="checkbox4"></label>
								</div>
							</div>
						</li>
					</td>
				</th:block>
			</th:block>
		</tr>
	</tbody>
</table>
<div style="display: inline-flex;justify-content: space-between;width: 1330px;">
	<div style="min-width: 500px;">
		<h6 style="display: flex;justify-content: space-between;" id="divProfitByProduct">Profits from products($):
			<span><strong id="profitByProduct">0</strong></span>
		</h6>
		<h6 style="display: flex;justify-content: space-between;" id="divProfitByProductNoConf">Profits from products no
			confirm($):
			<span>- <strong id="profitByProductNoConf">0</strong></span>
		</h6>
		<h6 style="display: flex;justify-content: space-between;" id="divPriceVoucherAofSupp">Price Voucher
			iLA($) (if any):
			<span>- <strong id="priceVoucherAofSupp">..</strong></span>
		</h6>
		<h6 style="display: flex;justify-content: space-between;" id="divFeeService">Fee Service($):
			<span><strong id="priceFeeService">..</strong></span>
		</h6>
		<hr>
		<h6 style="display: flex;justify-content: space-between;" id="divProfitReceive">iLA profits will receive($):
			<span><strong id="profitReceive">0</strong></span>
		</h6>
	</div>
	<div style="min-width: 500px;">
		<p hidden id="textIdInv" th:text="${idInv}"></p>
		<p hidden id="textIdSupp" th:text="${idSupp}"></p>
		<p hidden id="lstVoucherS" th:text="${lstVoucherS}"></p>
		<p hidden id="idUser" th:text="${idUser}"></p>
		<h6 style="display: flex;justify-content: space-between;">Total Price($):
			<strong id="totalPrice">100</strong>
		</h6>
		<h6 style="display: flex;justify-content: space-between;" id="divRefundCus">Refund to
			customers($) (if any): <span>- <strong id="refundCus">0</strong></span></h6>
		<h6 style="display: flex;justify-content: space-between;" id="divPriceVoucherS">Price Voucher Supplier($) (if
			any):
			<span>- <strong id="priceVoucherS">0</strong></span>
		</h6>
		<h6 style="display: flex;justify-content: space-between;" id="divProfit">Profit for iLA($): <span>- <strong
					id="profitILA">....</strong><strong id="strong00profit">.00</strong></span>
		</h6>

		<hr>
		<h6 style="display: flex;justify-content: space-between;" id="divMoneyPaid">The remaining amount must be
			paid($):
			<span>
				<strong id="moneyReceived">...</strong> <strong id="msgPaid"></strong>
			</span>
		</h6>
		<h6 style="display: flex;justify-content: space-between;" id="divPriceRefundVSupp">Voucher refund for
			Supplier($):
			<strong id="priceRefundVSupp">0</strong>
		</h6>
	</div>
</div>


<script th:inline="javascript">
	function roundToTwo(num) {
		return +(Math.round(num + "e+2") + "e-2");
	}

	/*<![CDATA[*/
	var theList = /*[[${lstDetailOrderBySupp}]]*/"";
	var priceVoucherA = /*[[${priceVoucherA}]]*/"";
	var quantityProd =/*[[${quantityProd}]]*/"";
	var moneyOfSupp = /*[[${moneyOfSupp}]]*/"";
	var idInv = $("#textIdInv").text();


	if (Number.isInteger(moneyOfSupp)) {
		$("#moneyReceived").text(moneyOfSupp + ".00");
	} else {
		$("#moneyReceived").text(roundToTwo(moneyOfSupp));
	}


	var temp = 0;
	var i = 0;
	var totalPriceProd = 0;
	var count = 0;
	for (i = 0; i < theList.length; i++) {
		temp += (0.1 * (theList[i].price));
		totalPriceProd += theList[i].price;
		$("#tdPriceOrder" + i).text(parseFloat(theList[i].priceOrder));
		if (theList[i].isStatus == 2 || theList[i].isStatus == 3) {
			count += 1;
		}
	}

	$(document).ready(function () {
		var strRefundCus = $("#refundCus").text();

		if (strRefundCus.includes("(No refund yet)")) {
			var refundCus = strRefundCus.replace("(No refund yet)", "");
			$("#btnRefundCus").show();
		} else if (strRefundCus.includes("(Refunded)")) {
			var refundCus = strRefundCus.replace("(Refunded)", "");
			$("#btnRefundCus").hide();
		} else {
			var refundCus = 0;
			$("#btnRefundCus").hide();
		}

		if ($("#priceRefundVSupp").text() != 0) {
			var profit = 0;
		} else {
			if (refundCus != 0) {
				var profit = temp - (0.1 * refundCus);
			} else {
				var profit = temp;
			}

		}
		if (profit > 0) {
			if (Number.isInteger(profit) == true) {
				$("#profitILA").text(profit);
				$("#strong00profit").show();
			} else {
				$("#profitILA").text(roundToTwo(profit));
				$("#strong00profit").hide();
			}
		} else {
			$("#profitILA").text(0);
			$("#strong00profit").show();
		}

		// ----- profit left -----
		if (Number.isInteger(temp)) {
			$("#profitByProduct").text(temp + ".00");
		} else {
			$("#profitByProduct").text(roundToTwo(temp));
		}


		if (refundCus != 0) {
			var profitByProductNoConf = 0.1 * refundCus;
			if (Number.isInteger(profitByProductNoConf)) {
				$("#profitByProductNoConf").text(profitByProductNoConf + ".00");
			} else {
				$("#profitByProductNoConf").text(roundToTwo(profitByProductNoConf));
			}

		} else {
			$("#profitByProductNoConf").text("0.00");
		}
		if (priceVoucherA != 0) {
			var priceVoucherAofSupp = (priceVoucherA / quantityProd) * (i - count);
			if (Number.isInteger(priceVoucherAofSupp)) {
				$("#priceVoucherAofSupp").text(priceVoucherAofSupp + ".00");
			} else {
				$("#priceVoucherAofSupp").text(roundToTwo(priceVoucherAofSupp));
			}
		} else {
			$("#priceVoucherAofSupp").text("0.00");
		}
		var feeService = 0;
		if ($("#priceRefundVSupp").text() != 0) {
			$("#priceFeeService").text("0.00");
		} else {
			if ($("#priceVoucherS").text() != 0) {
				feeService = 0.02 * (totalPriceProd - $("#priceVoucherS").text());
				if (Number.isInteger(feeService)) {
					$("#priceFeeService").text(feeService + ".00");
				} else {
					$("#priceFeeService").text(roundToTwo(feeService));
				}
			} else {
				feeService = 0.02 * totalPriceProd;
				if (Number.isInteger(feeService)) {
					$("#priceFeeService").text(feeService + ".00");
				} else {
					$("#priceFeeService").text(roundToTwo(feeService));
				}
			}
		}

		//------
		if (refundCus != 0) {
			if (priceVoucherA != 0) {
				var priceVoucherAofSupp = roundToTwo((priceVoucherA / quantityProd) * (i - count));
				var profitReceive = temp - (0.1 * refundCus) - priceVoucherAofSupp + feeService;
				if (Number.isInteger(profitReceive)) {
					$("#profitReceive").text(profitReceive + ".00");
				} else {
					$("#profitReceive").text(roundToTwo(profitReceive));
				}

			}
			else {
				var profitReceive = temp - (0.1 * refundCus) + feeService;
				if (Number.isInteger(profitReceive)) {
					$("#profitReceive").text(profitReceive + ".00");
				} else {
					$("#profitReceive").text(roundToTwo(profitReceive));
				}
			}
		} else {
			if (priceVoucherA != 0) {
				var priceVoucherAofSupp = roundToTwo((priceVoucherA / quantityProd) * (i - count));
				var profitReceive = temp - priceVoucherAofSupp + feeService;
				if (Number.isInteger(profitReceive)) {
					$("#profitReceive").text(profitReceive + ".00");
				} else {
					$("#profitReceive").text(roundToTwo(profitReceive));
				}
			}
			else {
				var profitReceive = temp + feeService;
				if (Number.isInteger(profitReceive)) {
					$("#profitReceive").text(profitReceive + ".00");
				} else {
					$("#profitReceive").text(roundToTwo(profitReceive));
				}
			}
		}
		

	});

	/*]]>*/
</script>