<!DOCTYPE html>
<html>

<head th:replace="Admin/Layout/admin_layout :: cssAdmin">

</head>
<link rel="stylesheet" href="/admin/vendors/simple-datatables/style.css">

<body>
	<div th:replace="Admin/Layout/admin_layout :: sidebarAdmin"></div>
	<div id="main">
		<nav th:replace="Admin/Layout/admin_layout :: navbarAdmin"></nav>
		<div class="modal text-left" id="animationProd" tabindex="-1" role="dialog" aria-labelledby="myModalLabel6"
			aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h4 class="modal-title" id="myModalLabelBtnProd"></h4>
						<button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
							<i data-feather="x"></i>
						</button>
					</div>
					<div class="modal-body">
						<div class="alert bg-rgba-success" role="alert">
							<span class="text-bold-600" id="messBtnProd"></span>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-light-secondary" data-bs-dismiss="modal">
							<i class="bx bx-x d-block d-sm-none"></i>
							<span class="d-none d-sm-block">Close</span>
						</button>
						<form id="form-update-prod">
							<input hidden id="id" name="id">
							<input hidden id="idSupplier" name="idSupplier">
							<input hidden id="isActive" name="isActive">
							<button type="button" id="submitUpdateProd" class="btn btn-primary ml-1"
								data-bs-dismiss="modal">
								<i class="bx bx-check d-block d-sm-none"></i>
								<span class="d-none d-sm-block" id="btnSubmitProd">Deactive</span>
							</button>
						</form>
					</div>
				</div>
			</div>
		</div>

		<div class="modal fade" id="modalDetailProd" tabindex="-1" role="dialog" aria-labelledby="modalDetailProdTitle"
			aria-hidden="true">
			<div class="modal-dialog modal-dialog-scrollable" role="document" style="max-width: 1200px;">
				<div class="modal-content" style="max-height: 662px;" id="componentTableDetailProd">
					<div class="modal-header">
						<h5 class="modal-title" id="modalDetailProdTitle">Product Detail</h5>
						<button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
							<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
								fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
								stroke-linejoin="round" class="feather feather-x">
								<line x1="18" y1="6" x2="6" y2="18"></line>
								<line x1="6" y1="6" x2="18" y2="18"></line>
							</svg>
						</button>
					</div>
					<div class="modal-body">
						<!-- product details area start -->
						<div class="product-details__area pt-120 pb-110">
							<div class="container">
								<div class="row">
									<div class="col-xl-6">
										<div class="product-details__wrapper" style="display: flex; flex-wrap: wrap;">
											<div class="pd-img"
												style="border: 1px solid #E2DFDD;margin-right: 10px;flex: 0 0 80%;-ms-flex: 0 0 80%;max-width: 80%;">
												<div class="tab-content" id="pdContent">
													<div class="tab-pane fade show active" id="pd-1" role="tabpanel"
														aria-labelledby="pd-1-tab">
														<div class="big-img"
															style="min-height: 515px;display: -ms-flexbox;display: flex;-ms-flex-wrap: wrap;flex-wrap: wrap;align-items: center;justify-content: center;">
															<img src="https://firebasestorage.googleapis.com/v0/b/ilacoffeeproject.appspot.com/o/DataTest-V%2Fe1.png?alt=media&amp;token=c28382d7-2c75-4b44-af27-7c00828d9b07&amp;_gl=1*118ro4g*_ga*NDIwMDI0ODAwLjE2ODE5MDQ5NjI.*_ga_CW55HF8NVT*MTY5NzgxOTk0NS40OC4xLjE2OTc4MjQ2NzcuNDguMC4w"
																alt="">
														</div>
													</div>
													<div class="tab-pane fade" id="pd-2" role="tabpanel"
														aria-labelledby="pd-2-tab">
														<div class="big-img"
															style="min-height: 515px;display: -ms-flexbox;display: flex;-ms-flex-wrap: wrap;flex-wrap: wrap;align-items: center;justify-content: center;">
															<img src="https://firebasestorage.googleapis.com/v0/b/ilacoffeeproject.appspot.com/o/DataTest-V%2Fe2.png?alt=media&amp;token=a3d47a21-6992-423f-b57c-01e21b3c34a7&amp;_gl=1*18jnun7*_ga*NDIwMDI0ODAwLjE2ODE5MDQ5NjI.*_ga_CW55HF8NVT*MTY5NzgxOTk0NS40OC4xLjE2OTc4MjQ2OTYuMjkuMC4w"
																alt="">
														</div>
													</div>
													<div class="tab-pane fade" id="pd-3" role="tabpanel"
														aria-labelledby="pd-3-tab">
														<div class="big-img"
															style="min-height: 515px;display: -ms-flexbox;display: flex;-ms-flex-wrap: wrap;flex-wrap: wrap;align-items: center;justify-content: center;">
															<img src="https://firebasestorage.googleapis.com/v0/b/ilacoffeeproject.appspot.com/o/DataTest-V%2Fe3.png?alt=media&amp;token=feba10eb-e0b6-409e-9a67-a4dae4aec0cf&amp;_gl=1*1jd6ssd*_ga*NDIwMDI0ODAwLjE2ODE5MDQ5NjI.*_ga_CW55HF8NVT*MTY5NzgxOTk0NS40OC4xLjE2OTc4MjQ3MDYuMTkuMC4w"
																alt="">
														</div>
													</div>
													<div class="tab-pane fade" id="pd-4" role="tabpanel"
														aria-labelledby="pd-4-tab">
														<div class="big-img"
															style="min-height: 515px;display: -ms-flexbox;display: flex;-ms-flex-wrap: wrap;flex-wrap: wrap;align-items: center;justify-content: center;">
															<img src="https://firebasestorage.googleapis.com/v0/b/ilacoffeeproject.appspot.com/o/DataTest-V%2Fe3.png?alt=media&amp;token=feba10eb-e0b6-409e-9a67-a4dae4aec0cf&amp;_gl=1*1jd6ssd*_ga*NDIwMDI0ODAwLjE2ODE5MDQ5NjI.*_ga_CW55HF8NVT*MTY5NzgxOTk0NS40OC4xLjE2OTc4MjQ3MDYuMTkuMC4w"
																alt="">
														</div>
													</div>
													<div class="tab-pane fade" id="pd-5" role="tabpanel"
														aria-labelledby="pd-5-tab">
														<div class="big-img"
															style="min-height: 515px;display: -ms-flexbox;display: flex;-ms-flex-wrap: wrap;flex-wrap: wrap;align-items: center;justify-content: center;">
															<img src="/images/products/pp-2.png" alt="">
														</div>
													</div>
												</div>
											</div>
											<div class="pd-tab"
												style="flex: 0 0 95px;-ms-flex: 0 0 95px;max-width: 95px;display: -ms-flexbox;display: flex; -ms-flex-wrap: wrap;flex-wrap: wrap;flex-direction: column;align-items: center;justify-content: center;">
												<nav>
													<div class="nav" id="shop-filter-tab" role="tablist">
														<a class="nav-link active" id="pd-1-tab" data-bs-toggle="tab"
															href="#pd-1" role="tab" aria-controls="pd-1"
															style="border: 1px solid #E2DFDD;width: 95px;height: 95px;display: -ms-flexbox;display: flex;-ms-flex-wrap: wrap;flex-wrap: wrap;justify-content: center;align-items: center;"
															aria-selected="true">
															<img src="https://firebasestorage.googleapis.com/v0/b/ilacoffeeproject.appspot.com/o/DataTest-V%2Fe1.png?alt=media&amp;token=c28382d7-2c75-4b44-af27-7c00828d9b07&amp;_gl=1*118ro4g*_ga*NDIwMDI0ODAwLjE2ODE5MDQ5NjI.*_ga_CW55HF8NVT*MTY5NzgxOTk0NS40OC4xLjE2OTc4MjQ2NzcuNDguMC4w"
																alt="err"
																onerror="this.onerror=null;this.src='/supplier/images/defaultImageProduct.png';"
																style="max-width: 60px;max-height: 60px;">
														</a>
														<a class="nav-link" id="pd-2-tab" data-bs-toggle="tab"
															href="#pd-2" role="tab" aria-controls="pd-2"
															style="border: 1px solid #E2DFDD;width: 95px;height: 95px;display: -ms-flexbox;display: flex;-ms-flex-wrap: wrap;flex-wrap: wrap;justify-content: center;align-items: center;"
															aria-selected="true">
															<img src="https://firebasestorage.googleapis.com/v0/b/ilacoffeeproject.appspot.com/o/DataTest-V%2Fe2.png?alt=media&amp;token=a3d47a21-6992-423f-b57c-01e21b3c34a7&amp;_gl=1*18jnun7*_ga*NDIwMDI0ODAwLjE2ODE5MDQ5NjI.*_ga_CW55HF8NVT*MTY5NzgxOTk0NS40OC4xLjE2OTc4MjQ2OTYuMjkuMC4w"
																alt="err"
																onerror="this.onerror=null;this.src='/supplier/images/defaultImageProduct.png';"
																style="max-width: 60px;max-height: 60px;">
														</a>
														<a class="nav-link" id="pd-3-tab" data-bs-toggle="tab"
															href="#pd-3" role="tab" aria-controls="pd-3"
															style="border: 1px solid #E2DFDD;width: 95px;height: 95px;display: -ms-flexbox;display: flex;-ms-flex-wrap: wrap;flex-wrap: wrap;justify-content: center;align-items: center;"
															aria-selected="true">
															<img src="https://firebasestorage.googleapis.com/v0/b/ilacoffeeproject.appspot.com/o/DataTest-V%2Fe3.png?alt=media&amp;token=feba10eb-e0b6-409e-9a67-a4dae4aec0cf&amp;_gl=1*1jd6ssd*_ga*NDIwMDI0ODAwLjE2ODE5MDQ5NjI.*_ga_CW55HF8NVT*MTY5NzgxOTk0NS40OC4xLjE2OTc4MjQ3MDYuMTkuMC4w"
																alt="err"
																onerror="this.onerror=null;this.src='/supplier/images/defaultImageProduct.png';"
																style="max-width: 60px;max-height: 60px;">
														</a>
													</div>
												</nav>
											</div>
										</div>
									</div>
									<div class="col-xl-6">
										<div class="product-details__content">
											<div class="tr-wrapper d-flex align-items-center justify-content-between">
												<h2 class="title" id="nameProdDetail">Cafe Du Monde Coffee Chicory, 15
													Ounce Ground</h2>
											</div>
											<p id="cateProdDetail">Category: ABCDEF</p>
											<p id="descriptionProdDetail">The coffee is brewed by first roasting the
												green coffee beans over hot
												coals in
												brazier.Once the beans are roasted each participant is given an
												opportunity to sample
												The coffee is brewed.</p>

											<h3 class="price" id="priceProdDetail">$650</h3>

										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn" data-bs-dismiss="modal">
							<i class="bx bx-x d-block d-sm-none"></i>
							<span class="d-none d-sm-block">Close</span>
						</button>
						<button type="button" class="btn btn-primary ml-1" data-bs-dismiss="modal">
							<i class="bx bx-check d-block d-sm-none"></i>
							<span class="d-none d-sm-block">Accept</span>
						</button>
					</div>
				</div>
			</div>
		</div>

		<div class="main-content container-fluid">
			<div class="page-title">
				<div class="row">
					<div class="col-12 col-md-6 order-md-1 order-last">
						<h3>Products Of Supplier </h3>
						<h3>(<span th:text="${nameSupp}"></span>)</h3>
					</div>
					<div class="col-12 col-md-6 order-md-2 order-first">
						<nav aria-label="breadcrumb" class='breadcrumb-header'>
							<ol class="breadcrumb">
								<li class="breadcrumb-item"><a href="/Admin/dashboard">Dashboard</a></li>
								<li class="breadcrumb-item">User Management</li>
								<li class="breadcrumb-item active" aria-current="page"><a href="/Admin/supplier-management">Supplier Management</a></li>
								<li class="breadcrumb-item active" aria-current="page">Products Of Supplier</li>
							</ol>
						</nav>
					</div>
				</div>
			</div>
			<section class="section">
				<div class="card">
					<div class="card-body">
						<div class="col-md-6 mb-4">
							<div class="input-group mb-3">
								<label class="input-group-text" for="inputGroupSelect01">Sort Status</label>
								<select class="form-select" id="isActiveFilter" name="sortData">
									<option value="allStt" select>All Status</option>
									<option value="0">Unapproved product</option>
									<option value="1">Approved product</option>
									<option value="2">Product refused</option>
								</select>
							</div>
						</div>
						<p hidden id="idSuppNow" th:text="${idSupp}"></p>
						<div id="tableProduct">
							<table class='table table-striped' id="table1">
								<thead>
									<tr>
										<th>Product Name</th>
										<th>Price</th>
										<th>Description</th>
										<th>Category</th>
										<th>Status</th>
										<th>Sold</th>
										<th>Details</th>
									</tr>
								</thead>
								<tbody>
									<th:block th:each="item : ${listProdOfSupp}">
										<tr>
											<td hidden th:text="${item.id}"></td>
											<td hidden th:text="${item.idSupplier}"></td>
											<td th:text="${item.title}"></td>
											<td th:text="${item.price}"></td>
											<td th:text="${item.description}"></td>
											<td th:text="${item.nameCate}"></td>

											<td th:switch="${item.isActive}">
												<th:block th:case="'0'">
													<button type="button" id="btnAcceptProd"
														class="btn btn-outline-success" data-bs-toggle="modal"
														data-bs-target="#animationProd">
														Accept
													</button>
													<button type="button" id="btnRefuseProd"
														class="btn btn-outline-danger" data-bs-toggle="modal"
														data-bs-target="#animationProd">
														Refuse
													</button>
												</th:block>

												<button th:case="'1'" id="btnDeacProd" type="button"
													class="btn btn-outline-danger" data-bs-toggle="modal"
													data-bs-target="#animationProd">
													Deactive
												</button>
												<span th:case="2" style="color: red;">Refused</span>
												<span th:case="3" style="color: red;">Deactived</span>
											</td>
											<td th:text="${item.sold}">2</td>
											<td>
												<button class="btn btn-primary" id="btnDetailProd"
													data-bs-toggle="modal"
													data-bs-target="#modalDetailProd">Detail</button>
											</td>
										</tr>
									</th:block>
								</tbody>
							</table>
						</div>

					</div>
				</div>

			</section>
		</div>
		<footer th:replace="Admin/Layout/admin_layout :: footerAdmin"></footer>
	</div>

	<div th:replace="Admin/Layout/admin_layout :: scriptAdmin"></div>

	<script src="/admin/vendors/simple-datatables/simple-datatables.js"></script>
	<script src="/admin/js/vendors.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>

	<script>
		$(document).ready(function () {
			$("#table1").on('click', '#btnDetailProd', function () {
				var currentRow = $(this).closest("tr");
				var idProd = currentRow.find("td:eq(0)").text(); // get current row 1st TD value
				var idSupp = currentRow.find("td:eq(1)").text();
				$.ajax({
					type: "Get",
					url: "/Admin/supplier-management/prodOfSupp/detail",  //remember change the controller to your owns.
					data: {
						idSupplier: idSupp,
						idPro: idProd
					},
					success: function (res) {
						$("#componentTableDetailProd").html("");
						$("#componentTableDetailProd").html(res);
						$("#btnAcceptProdDetail").click(function () {
							$("#id").val(idProd);
							$("#idSupplier").val(idSupp);
							$("#isActive").val(1);
							$("#myModalLabelBtnProd").text("Accept Product");
							$("#messBtnProd").text("Are you sure you want to accept this product?");
							$("#btnSubmitProd").text("Accept");

						});
						$("#btnRefuseProdDetail").click(function () {
							$("#id").val(idProd);
							$("#idSupplier").val(idSupp);
							$("#isActive").val(2);
							$("#myModalLabelBtnProd").text("Refuse Product");
							$("#messBtnProd").text("Are you sure you want to refuse this product?");
							$("#btnSubmitProd").text("Refuse");

						});
						$("#btnDeacProdDetail").click(function () {
							$("#id").val(idProd);
							$("#idSupplier").val(idSupp);
							$("#isActive").val(3);
							$("#myModalLabelBtnProd").text("Deactive Product");
							$("#messBtnProd").text("Are you sure you want to deactive this product?");
							$("#btnSubmitProd").text("Deactive");
						});

					},
					error: function (response) {
						console.log(response.responseText);
					}
				});
			});

			$("#table1").on('click', '#btnAcceptProd', function () {
				// get the current row
				var currentRow = $(this).closest("tr");

				var idProd = currentRow.find("td:eq(0)").text(); // get current row 1st TD value
				var idSupp = currentRow.find("td:eq(1)").text();
				$("#id").val(idProd);
				$("#idSupplier").val(idSupp);
				$("#isActive").val(1);
				$("#myModalLabelBtnProd").text("Accept Product");
				$("#messBtnProd").text("Are you sure you want to accept this product?");
				$("#btnSubmitProd").text("Accept");

			});
			$("#table1").on('click', '#btnRefuseProd', function () {
				// get the current row
				var currentRow = $(this).closest("tr");

				var idProd = currentRow.find("td:eq(0)").text(); // get current row 1st TD value
				var idSupp = currentRow.find("td:eq(1)").text();
				$("#id").val(idProd);
				$("#idSupplier").val(idSupp);
				$("#isActive").val(2);
				$("#myModalLabelBtnProd").text("Refuse Product");
				$("#messBtnProd").text("Are you sure you want to refuse this product?");
				$("#btnSubmitProd").text("Refuse");

			});
			$("#table1").on('click', '#btnDeacProd', function () {
				// get the current row
				var currentRow = $(this).closest("tr");

				var idProd = currentRow.find("td:eq(0)").text(); // get current row 1st TD value
				var idSupp = currentRow.find("td:eq(1)").text();
				$("#id").val(idProd);
				$("#idSupplier").val(idSupp);
				$("#isActive").val(3);
				$("#myModalLabelBtnProd").text("Deactive Product");
				$("#messBtnProd").text("Are you sure you want to deactive this product?");
				$("#btnSubmitProd").text("Deactive");

			});
			$("#submitUpdateProd").click(function () {
				$.ajax({
					type: "Post",
					url: "/Admin/supplier-management/update-product",  //remember change the controller to your owns.
					data: {
						id: $("#id").val(),
						isActive: $("#isActive").val(),
						idSupplier: $('#idSupplier').val()
					},
					success: function (res) {
						$("#tableProduct").html("");
						$("#tableProduct").html(res);
						let tableProd = document.querySelector('#table1');
						let dataTableProd = new simpleDatatables.DataTable(tableProd);
					},
					error: function (response) {
						console.log(response.responseText);
					}
				});
			});
		});
	</script>
	<script>
		$(document).ready(function () {
			$("#isActiveFilter").change(function () {
				if ($('#isActiveFilter').val() != "allStt") {
					$.ajax({
						type: "Get",
						url: "/Admin/supplier-management/filter",  //remember change the controller to your owns.
						data: {
							isActive: $('#isActiveFilter').val(),
							idSupplier: $('#idSuppNow').text()
						},
						success: function (res) {
							$("#tableProduct").html("");
							$("#tableProduct").html(res);
							let tableProd = document.querySelector('#table1');
							let dataTableProd = new simpleDatatables.DataTable(tableProd);
						},
						error: function (response) {
							console.log(response.responseText);
						}
					});
				} else {
					location.reload();
				}


			})
		});

	</script>